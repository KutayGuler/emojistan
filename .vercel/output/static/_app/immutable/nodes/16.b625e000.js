import{S as pe,i as be,s as ge,a as M,k as y,q,a5 as ve,h as u,c as C,l as S,m as g,r as G,n as o,b as D,G as i,P as V,g as $,K as de,O as te,a2 as he,T as Y,E as ke,o as we,ag as Ee,a0 as Q,a1 as X,$ as _e,W as ye,w as Se,u as Ne,U as oe}from"../chunks/index.8e69b878.js";import{g as ee}from"../chunks/navigation.bc243d4b.js";import{s as K}from"../chunks/store.55a48864.js";import{f as me}from"../chunks/index.8d01d5d1.js";import{n as Oe}from"../chunks/notifications.048afdce.js";const{document:ne}=Ee;function ae(t,e,l){const r=t.slice();return r[23]=e[l][0],r[24]=e[l][1],r[26]=l,r}function ie(t,e,l){const r=t.slice();return r[27]=e[l],r}function ce(t){let e,l,r,h;return{c(){e=y("button"),l=q("OPEN"),this.h()},l(c){e=S(c,"BUTTON",{class:!0});var a=g(e);l=G(a,"OPEN"),a.forEach(u),this.h()},h(){o(e,"class","btn")},m(c,a){D(c,e,a),i(e,l),r||(h=V(e,"click",t[9]),r=!0)},p:te,d(c){c&&u(e),r=!1,h()}}}function Te(t){let e,l,r=t[24]+"",h,c,a,n,_,k,f;function d(){return t[17](t[24],t[26])}return{c(){e=y("div"),l=y("h3"),h=q(r),c=M(),a=y("button"),n=Q("svg"),_=Q("path"),this.h()},l(N){e=S(N,"DIV",{class:!0});var E=g(e);l=S(E,"H3",{});var B=g(l);h=G(B,r),B.forEach(u),c=C(E),a=S(E,"BUTTON",{class:!0});var A=g(a);n=X(A,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var x=g(n);_=X(x,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),g(_).forEach(u),x.forEach(u),A.forEach(u),E.forEach(u),this.h()},h(){o(_,"stroke-linecap","round"),o(_,"stroke-linejoin","round"),o(_,"d","M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"),o(n,"xmlns","http://www.w3.org/2000/svg"),o(n,"fill","none"),o(n,"viewBox","0 0 24 24"),o(n,"stroke-width","1.5"),o(n,"stroke","currentColor"),o(n,"class","h-6 w-6"),o(a,"class","w-fit pl-0 text-slate-500"),o(e,"class","flex gap-2 pb-4")},m(N,E){D(N,e,E),i(e,l),i(l,h),i(e,c),i(e,a),i(a,n),i(n,_),k||(f=V(a,"click",d),k=!0)},p(N,E){t=N,E&32&&r!==(r=t[24]+"")&&Ne(h,r)},d(N){N&&u(e),k=!1,f()}}}function je(t){let e,l,r,h,c,a,n,_;function k(){return t[16](t[23])}return{c(){e=y("form"),l=y("input"),r=M(),h=y("button"),c=Q("svg"),a=Q("path"),this.h()},l(f){e=S(f,"FORM",{class:!0});var d=g(e);l=S(d,"INPUT",{class:!0,type:!0}),r=C(d),h=S(d,"BUTTON",{type:!0});var N=g(h);c=X(N,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var E=g(c);a=X(E,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),g(a).forEach(u),E.forEach(u),N.forEach(u),d.forEach(u),this.h()},h(){l.autofocus=!0,o(l,"class","input-bordered input input-sm"),o(l,"type","text"),o(a,"stroke-linecap","round"),o(a,"stroke-linejoin","round"),o(a,"d","M4.5 12.75l6 6 9-13.5"),o(c,"xmlns","http://www.w3.org/2000/svg"),o(c,"fill","none"),o(c,"viewBox","0 0 24 24"),o(c,"stroke-width","1.5"),o(c,"stroke","currentColor"),o(c,"class","h-6 w-6"),o(h,"type","submit"),o(e,"class","pb-4")},m(f,d){D(f,e,d),i(e,l),oe(l,t[1]),i(e,r),i(e,h),i(h,c),i(c,a),l.focus(),n||(_=[V(l,"input",t[15]),V(e,"submit",k)],n=!0)},p(f,d){t=f,d&2&&l.value!==t[1]&&oe(l,t[1])},d(f){f&&u(e),n=!1,Y(_)}}}function ue(t){let e,l;return{c(){e=y("i"),this.h()},l(r){e=S(r,"I",{class:!0}),g(e).forEach(u),this.h()},h(){o(e,"class",l="twa text-4xl twa-"+t[27])},m(r,h){D(r,e,h)},p(r,h){h&32&&l!==(l="twa text-4xl twa-"+r[27])&&o(e,"class",l)},d(r){r&&u(e)}}}function Be(t){let e,l,r,h;function c(){return t[21](t[26])}return{c(){e=y("button"),l=q("DELETE"),this.h()},l(a){e=S(a,"BUTTON",{class:!0});var n=g(e);l=G(n,"DELETE"),n.forEach(u),this.h()},h(){o(e,"class","btn-ghost btn-sm btn border-none hover:border-none hover:bg-error")},m(a,n){D(a,e,n),i(e,l),r||(h=V(e,"click",c),r=!0)},p(a,n){t=a},d(a){a&&u(e),r=!1,h()}}}function Ie(t){let e,l,r,h,c,a,n,_;function k(){return t[19](t[23])}return{c(){e=y("form"),l=y("button"),r=q("CONFIRM"),h=M(),c=y("button"),a=q("CANCEL"),this.h()},l(f){e=S(f,"FORM",{});var d=g(e);l=S(d,"BUTTON",{class:!0});var N=g(l);r=G(N,"CONFIRM"),N.forEach(u),d.forEach(u),h=C(f),c=S(f,"BUTTON",{class:!0});var E=g(c);a=G(E,"CANCEL"),E.forEach(u),this.h()},h(){o(l,"class","btn-error btn-sm btn"),o(c,"class","btn-sm btn")},m(f,d){D(f,e,d),i(e,l),i(l,r),D(f,h,d),D(f,c,d),i(c,a),n||(_=[V(e,"submit",k),V(c,"click",t[20])],n=!0)},p(f,d){t=f},d(f){f&&u(e),f&&u(h),f&&u(c),n=!1,Y(_)}}}function fe(t){let e,l,r,h,c,a,n,_,k,f,d,N,E,B,A,x,R,L,H,z;function T(w,j){return w[0]===w[26]?je:Te}let P=T(t),m=P(t),p=[...t[6].get(t[23])||[]],b=[];for(let w=0;w<p.length;w+=1)b[w]=ue(ie(t,p,w));function s(){return t[18](t[23])}function I(w,j){return w[2]===w[26]?Ie:Be}let U=I(t),v=U(t);function W(){return t[22](t[23])}return{c(){e=y("div"),m.c(),l=M(),r=y("p");for(let w=0;w<b.length;w+=1)b[w].c();h=M(),c=y("div"),a=M(),n=y("div"),_=y("button"),k=Q("svg"),f=Q("path"),d=M(),N=y("div"),E=M(),v.c(),B=M(),A=y("button"),x=q("OPEN"),R=M(),this.h()},l(w){e=S(w,"DIV",{class:!0});var j=g(e);m.l(j),l=C(j),r=S(j,"P",{});var O=g(r);for(let Z=0;Z<b.length;Z+=1)b[Z].l(O);O.forEach(u),h=C(j),c=S(j,"DIV",{class:!0}),g(c).forEach(u),a=C(j),n=S(j,"DIV",{class:!0});var J=g(n);_=S(J,"BUTTON",{title:!0,class:!0});var le=g(_);k=X(le,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var re=g(k);f=X(re,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),g(f).forEach(u),re.forEach(u),le.forEach(u),d=C(J),N=S(J,"DIV",{class:!0}),g(N).forEach(u),E=C(J),v.l(J),B=C(J),A=S(J,"BUTTON",{class:!0});var se=g(A);x=G(se,"OPEN"),se.forEach(u),J.forEach(u),R=C(j),j.forEach(u),this.h()},h(){o(c,"class","flex flex-grow"),o(f,"stroke-linecap","round"),o(f,"stroke-linejoin","round"),o(f,"d","M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"),o(k,"xmlns","http://www.w3.org/2000/svg"),o(k,"fill","none"),o(k,"viewBox","0 0 24 24"),o(k,"stroke-width","1.5"),o(k,"stroke","currentColor"),o(k,"class","h-6 w-6"),o(_,"title","Download save file"),o(_,"class","btn-ghost btn-sm btn"),o(N,"class","flex flex-grow"),o(A,"class","btn-sm btn"),o(n,"class","flex w-full flex-row items-end gap-2 self-end"),o(e,"class","brutal relative mb-2 flex h-56 flex-col rounded-lg bg-slate-300 p-4")},m(w,j){D(w,e,j),m.m(e,null),i(e,l),i(e,r);for(let O=0;O<b.length;O+=1)b[O]&&b[O].m(r,null);i(e,h),i(e,c),i(e,a),i(e,n),i(n,_),i(_,k),i(k,f),i(n,d),i(n,N),i(n,E),v.m(n,null),i(n,B),i(n,A),i(A,x),i(e,R),H||(z=[V(_,"click",s),V(A,"click",W)],H=!0)},p(w,j){if(t=w,P===(P=T(t))&&m?m.p(t,j):(m.d(1),m=P(t),m&&(m.c(),m.m(e,l))),j&96){p=[...t[6].get(t[23])||[]];let O;for(O=0;O<p.length;O+=1){const J=ie(t,p,O);b[O]?b[O].p(J,j):(b[O]=ue(J),b[O].c(),b[O].m(r,null))}for(;O<b.length;O+=1)b[O].d(1);b.length=p.length}U===(U=I(t))&&v?v.p(t,j):(v.d(1),v=U(t),v&&(v.c(),v.m(n,B)))},i(w){L||de(()=>{L=_e(e,me,{delay:(t[26]+1)*80,x:200}),L.start()})},o:te,d(w){w&&u(e),m.d(),he(b,w),v.d(),H=!1,Y(z)}}}function Ae(t){let e,l,r,h,c,a,n,_,k,f,d,N,E,B,A,x,R,L,H,z,T=t[3]&&ce(t),P=[...t[5].saves],m=[];for(let p=0;p<P.length;p+=1)m[p]=fe(ae(t,P,p));return{c(){e=M(),l=y("div"),r=y("h1"),h=q("Play"),c=M(),a=y("div"),n=y("label"),_=y("span"),k=q("Drop files here"),f=q(`\r
			or\r
			`),d=y("input"),N=M(),T&&T.c(),E=M(),B=y("button"),A=q("NEW GAME"),R=M(),L=y("div");for(let p=0;p<m.length;p+=1)m[p].c();this.h()},l(p){ve("svelte-k9s0x6",ne.head).forEach(u),e=C(p),l=S(p,"DIV",{class:!0});var s=g(l);r=S(s,"H1",{class:!0});var I=g(r);h=G(I,"Play"),I.forEach(u),c=C(s),a=S(s,"DIV",{class:!0});var U=g(a);n=S(U,"LABEL",{for:!0,class:!0});var v=g(n);_=S(v,"SPAN",{class:!0});var W=g(_);k=G(W,"Drop files here"),W.forEach(u),f=G(v,`\r
			or\r
			`),d=S(v,"INPUT",{type:!0,id:!0,accept:!0}),N=C(v),T&&T.l(v),v.forEach(u),E=C(U),B=S(U,"BUTTON",{class:!0});var w=g(B);A=G(w,"NEW GAME"),w.forEach(u),U.forEach(u),R=C(s),L=S(s,"DIV",{class:!0});var j=g(L);for(let O=0;O<m.length;O+=1)m[O].l(j);j.forEach(u),s.forEach(u),this.h()},h(){ne.title="Emojistan",o(r,"class","pl-4 text-6xl"),o(_,"class","drop-title"),o(d,"type","file"),o(d,"id","save-file"),o(d,"accept","application/json"),d.required=!0,o(n,"for","save-file"),o(n,"class","relative flex h-28 flex-grow cursor-pointer flex-col items-center justify-center gap-2 rounded border-2 border-dashed border-black hover:bg-gray-300"),o(B,"class","btn-primary btn h-28 flex-grow text-4xl"),o(a,"class","flex w-full gap-2 px-4"),o(L,"class","h-full overflow-y-auto overflow-x-hidden px-4"),o(l,"class","flex h-full flex-col gap-4")},m(p,b){D(p,e,b),D(p,l,b),i(l,r),i(r,h),i(l,c),i(l,a),i(a,n),i(n,_),i(_,k),i(n,f),i(n,d),t[13](d),i(n,N),T&&T.m(n,null),i(a,E),i(a,B),i(B,A),i(l,R),i(l,L);for(let s=0;s<m.length;s+=1)m[s]&&m[s].m(L,null);H||(z=[V(window,"keydown",t[11]),V(d,"change",t[12]),V(d,"change",t[14]),V(B,"click",t[7])],H=!0)},p(p,[b]){if(p[3]?T?T.p(p,b):(T=ce(p),T.c(),T.m(n,null)):T&&(T.d(1),T=null),b&359){P=[...p[5].saves];let s;for(s=0;s<P.length;s+=1){const I=ae(p,P,s);m[s]?(m[s].p(I,b),$(m[s],1)):(m[s]=fe(I),m[s].c(),$(m[s],1),m[s].m(L,null))}for(;s<m.length;s+=1)m[s].d(1);m.length=P.length}},i(p){x||de(()=>{x=_e(B,me,{x:200}),x.start()});for(let b=0;b<P.length;b+=1)$(m[b])},o:te,d(p){p&&u(e),p&&u(l),t[13](null),T&&T.d(),he(m,p),H=!1,Y(z)}}}function F(t){return Object.fromEntries(JSON.parse(localStorage.getItem(t)))}function Ue(t){const e={map:{items:F(t+"_items"),backgrounds:F(t+"_backgrounds"),colors:F(t+"_colors"),dbg:localStorage.getItem(t+"_dbg"),ssi:localStorage.getItem(t+"_ssi")},rbxs:Array.from(JSON.parse(localStorage.getItem(t+"_rbxs"))),pushers:F(t+"_pushers"),mergers:F(t+"_mergers"),effectors:F(t+"_effectors"),interactables:F(t+"_interactables"),controllables:F(t+"_controllables"),sequencers:F(t+"_sequencers"),dt:F(t+"_dt")};let l="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e)),r=document.createElement("a");r.setAttribute("href",l),r.setAttribute("download","emojistan-"+t+".json"),document.body.appendChild(r),r.click(),r.remove()}function Me(t,e,l){let r;ke(t,K,s=>l(5,r=s));let{data:h}=e,c=new Map;we(()=>{r.currentSaveID===""&&K.useStorage();for(let[s,I]of r.saves){let U=JSON.parse(localStorage.getItem(s+"_items")),v=new Set(U.map(([W,w])=>w));for(;v.size>8;)v.delete(v.values().next().value);c.set(s,v)}});function a(){K.add(new Intl.DateTimeFormat("en-GB",{dateStyle:"full",timeStyle:"short"}).format(new Date)),ee("/editor")}function n(s){ye(K,r.currentSaveID=s,r),ee("/editor")}let _=-1,k="",f=-1,d;async function N(){let s=await d[0].text(),I=JSON.parse(s);K.add("Upload-"+new Intl.DateTimeFormat("en-GB",{dateStyle:"full",timeStyle:"short"}).format(new Date));const U=r.currentSaveID;for(let v of Object.keys(I))if(v==="map")for(let W of Object.keys(I.map))W==="dbg"?localStorage.setItem(U+"_dbg",I.map.dbg):localStorage.setItem(U+"_"+W,JSON.stringify(Object.entries(I.map[W])));else v==="rbxs"?localStorage.setItem(U+"_"+v,JSON.stringify(Array.from(I[v]))):localStorage.setItem(U+"_"+v,JSON.stringify(Object.entries(I[v])));ee("/editor")}let E;const B=s=>{s.code==="Escape"&&(l(0,_=-1),l(2,f=-1))};function A(){d=this.files,l(3,d)}function x(s){Se[s?"unshift":"push"](()=>{E=s,l(4,E)})}const R=()=>{d[0].type!="application/json"&&(l(4,E.value="",E),l(3,d=!1),Oe.danger("Wrong file type. Save files should be in JSON format."))};function L(){k=this.value,l(1,k)}const H=s=>{K.rename(s,k),l(0,_=-1)},z=(s,I)=>{l(1,k=s),l(0,_=I)},T=s=>Ue(s),P=s=>{K.delete(s),location.reload()},m=()=>{l(2,f=-1)},p=s=>{l(2,f=s)},b=s=>n(s);return t.$$set=s=>{"data"in s&&l(10,h=s.data)},[_,k,f,d,E,r,c,a,n,N,h,B,A,x,R,L,H,z,T,P,m,p,b]}class Je extends pe{constructor(e){super(),be(this,e,Me,Ae,ge,{data:10})}}export{Je as component};
