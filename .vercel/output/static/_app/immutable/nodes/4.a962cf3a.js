import{S as re,i as ie,s as ne,e as R,b as N,d as X,f as ue,g as Z,h as m,E as fe,v as ce,X as _e,k as b,a as T,q as U,l as v,m as w,c as V,r as B,n as h,G as _,u as C,Y as me,Z as pe,_ as de,a2 as he,O as x,P as J,U as ee,a4 as be,T as ve}from"../chunks/index.8e69b878.js";import{n as j}from"../chunks/notifications.048afdce.js";import{p as we}from"../chunks/stores.986fa1bf.js";import{g as ke}from"../chunks/navigation.bc243d4b.js";function le(f,e,l){var a;const r=f.slice();r[10]=e[l].title,r[11]=e[l].count;const t=r[10].toLowerCase();r[12]=t;const s=r[12]!=""&&((a=r[4].route.id)==null?void 0:a.includes(r[12]));return r[13]=s,r}function Ee(f){let e,l,r,t,s,a,o,i=f[4].params.username+"",n,u,p,L,d,Y,O,D,q,P,S,G,y=!f[0].isOwner&&te(f),W=f[3],k=[];for(let c=0;c<W.length;c+=1)k[c]=ae(le(f,W,c));const z=f[8].default,I=_e(z,f,f[7],null);return{c(){e=b("div"),l=b("div"),r=b("div"),t=b("div"),s=b("i"),a=T(),o=b("h1"),n=U(i),u=T(),y&&y.c(),p=T(),L=b("div"),d=b("a"),Y=U("Bio"),q=T();for(let c=0;c<k.length;c+=1)k[c].c();P=T(),S=b("div"),I&&I.c(),this.h()},l(c){e=v(c,"DIV",{class:!0});var E=w(e);l=v(E,"DIV",{class:!0});var F=w(l);r=v(F,"DIV",{class:!0});var g=w(r);t=v(g,"DIV",{class:!0});var A=w(t);s=v(A,"I",{class:!0}),w(s).forEach(m),A.forEach(m),g.forEach(m),a=V(F),o=v(F,"H1",{class:!0});var K=w(o);n=B(K,i),K.forEach(m),u=V(F),y&&y.l(F),F.forEach(m),p=V(E),L=v(E,"DIV",{class:!0});var H=w(L);d=v(H,"A",{href:!0,class:!0});var Q=w(d);Y=B(Q,"Bio"),Q.forEach(m),q=V(H);for(let M=0;M<k.length;M+=1)k[M].l(H);H.forEach(m),P=V(E),S=v(E,"DIV",{class:!0});var $=w(S);I&&I.l($),$.forEach(m),E.forEach(m),this.h()},h(){var c;h(s,"class","twa twa-alien text-2xl"),h(t,"class","w-12 rounded-full bg-neutral text-neutral-content"),h(r,"class","placeholder avatar"),h(o,"class","text-4xl"),h(l,"class","flex flex-row items-center justify-start gap-4"),h(d,"href",O="/profile/"+f[4].params.username),h(d,"class",D="tab "+(((c=f[4].route.id)==null?void 0:c.at(-1))=="]"?"brutal tab-active":"")),h(L,"class","tabs tabs-boxed z-10 w-full"),h(S,"class","brutal flex h-full w-full flex-col overflow-y-auto overflow-x-hidden rounded bg-neutral p-4 text-neutral-content"),h(e,"class","flex h-full flex-col gap-4")},m(c,E){N(c,e,E),_(e,l),_(l,r),_(r,t),_(t,s),_(l,a),_(l,o),_(o,n),_(l,u),y&&y.m(l,null),_(e,p),_(e,L),_(L,d),_(d,Y),_(L,q);for(let F=0;F<k.length;F+=1)k[F]&&k[F].m(L,null);_(e,P),_(e,S),I&&I.m(S,null),G=!0},p(c,E){var F;if((!G||E&16)&&i!==(i=c[4].params.username+"")&&C(n,i),c[0].isOwner?y&&(y.d(1),y=null):y?y.p(c,E):(y=te(c),y.c(),y.m(l,null)),(!G||E&16&&O!==(O="/profile/"+c[4].params.username))&&h(d,"href",O),(!G||E&16&&D!==(D="tab "+(((F=c[4].route.id)==null?void 0:F.at(-1))=="]"?"brutal tab-active":"")))&&h(d,"class",D),E&24){W=c[3];let g;for(g=0;g<W.length;g+=1){const A=le(c,W,g);k[g]?k[g].p(A,E):(k[g]=ae(A),k[g].c(),k[g].m(L,null))}for(;g<k.length;g+=1)k[g].d(1);k.length=W.length}I&&I.p&&(!G||E&128)&&me(I,z,c,c[7],G?de(z,c[7],E,null):pe(c[7]),null)},i(c){G||(Z(I,c),G=!0)},o(c){X(I,c),G=!1},d(c){c&&m(e),y&&y.d(),he(k,c),I&&I.d(c)}}}function ye(f){let e;function l(s,a){return s[0].isOwner?Fe:ge}let r=l(f),t=r(f);return{c(){t.c(),e=R()},l(s){t.l(s),e=R()},m(s,a){t.m(s,a),N(s,e,a)},p(s,a){r===(r=l(s))&&t?t.p(s,a):(t.d(1),t=r(s),t&&(t.c(),t.m(e.parentNode,e)))},i:x,o:x,d(s){t.d(s),s&&m(e)}}}function te(f){let e,l=f[0].youFollow?"FOLLOWING":"FOLLOW",r,t,s,a,o,i,n=f[0].followsYou&&se();return{c(){e=b("button"),r=U(l),s=T(),n&&n.c(),a=R(),this.h()},l(u){e=v(u,"BUTTON",{class:!0});var p=w(e);r=B(p,l),p.forEach(m),s=V(u),n&&n.l(u),a=R(),this.h()},h(){h(e,"class",t="btn-sm btn "+(f[0].youFollow?"btn-primary":""))},m(u,p){N(u,e,p),_(e,r),N(u,s,p),n&&n.m(u,p),N(u,a,p),o||(i=J(e,"click",f[6]),o=!0)},p(u,p){p&1&&l!==(l=u[0].youFollow?"FOLLOWING":"FOLLOW")&&C(r,l),p&1&&t!==(t="btn-sm btn "+(u[0].youFollow?"btn-primary":""))&&h(e,"class",t),u[0].followsYou?n||(n=se(),n.c(),n.m(a.parentNode,a)):n&&(n.d(1),n=null)},d(u){u&&m(e),u&&m(s),n&&n.d(u),u&&m(a),o=!1,i()}}}function se(f){let e,l;return{c(){e=b("div"),l=U("Follows You"),this.h()},l(r){e=v(r,"DIV",{class:!0});var t=w(e);l=B(t,"Follows You"),t.forEach(m),this.h()},h(){h(e,"class","badge badge-sm p-2")},m(r,t){N(r,e,t),_(e,l)},d(r){r&&m(e)}}}function ae(f){let e,l=f[10]+"",r,t,s=f[11]+"",a,o,i,n;return{c(){e=b("a"),r=U(l),t=T(),a=U(s),o=T(),this.h()},l(u){e=v(u,"A",{href:!0,class:!0});var p=w(e);r=B(p,l),t=V(p),a=B(p,s),o=V(p),p.forEach(m),this.h()},h(){h(e,"href",i="/profile/"+f[4].params.username+"/"+f[12]),h(e,"class",n="tab "+(f[13]?"brutal tab-active":""))},m(u,p){N(u,e,p),_(e,r),_(e,t),_(e,a),_(e,o)},p(u,p){p&8&&l!==(l=u[10]+"")&&C(r,l),p&8&&s!==(s=u[11]+"")&&C(a,s),p&24&&i!==(i="/profile/"+u[4].params.username+"/"+u[12])&&h(e,"href",i),p&24&&n!==(n="tab "+(u[13]?"brutal tab-active":""))&&h(e,"class",n)},d(u){u&&m(e)}}}function ge(f){let e,l,r,t,s=f[4].params.username+"",a,o;return{c(){e=b("div"),l=b("i"),r=T(),t=b("h2"),a=U(s),o=U(" is not here"),this.h()},l(i){e=v(i,"DIV",{class:!0});var n=w(e);l=v(n,"I",{class:!0}),w(l).forEach(m),r=V(n),t=v(n,"H2",{});var u=w(t);a=B(u,s),o=B(u," is not here"),u.forEach(m),n.forEach(m),this.h()},h(){h(l,"class","twa twa-face-in-clouds scale-150 text-9xl"),h(e,"class","flex h-full w-full flex-col items-center justify-center gap-12")},m(i,n){N(i,e,n),_(e,l),_(e,r),_(e,t),_(t,a),_(t,o)},p(i,n){n&16&&s!==(s=i[4].params.username+"")&&C(a,s)},d(i){i&&m(e)}}}function Fe(f){let e,l,r,t,s=!f[2]&&oe(f);return{c(){e=b("h2"),l=U("You don't have a username. Enter a username to make your profile public."),r=T(),s&&s.c(),t=R()},l(a){e=v(a,"H2",{});var o=w(e);l=B(o,"You don't have a username. Enter a username to make your profile public."),o.forEach(m),r=V(a),s&&s.l(a),t=R()},m(a,o){N(a,e,o),_(e,l),N(a,r,o),s&&s.m(a,o),N(a,t,o)},p(a,o){a[2]?s&&(s.d(1),s=null):s?s.p(a,o):(s=oe(a),s.c(),s.m(t.parentNode,t))},d(a){a&&m(e),a&&m(r),s&&s.d(a),a&&m(t)}}}function oe(f){let e,l,r,t,s,a,o;return{c(){e=b("form"),l=b("input"),r=T(),t=b("button"),s=U("ENTER"),this.h()},l(i){e=v(i,"FORM",{});var n=w(e);l=v(n,"INPUT",{type:!0,class:!0}),r=V(n),t=v(n,"BUTTON",{type:!0,class:!0});var u=w(t);s=B(u,"ENTER"),u.forEach(m),n.forEach(m),this.h()},h(){l.required=!0,h(l,"type","text"),h(l,"class","input-bordered input mt-4"),h(t,"type","submit"),h(t,"class","btn-primary btn")},m(i,n){N(i,e,n),_(e,l),ee(l,f[1]),_(e,r),_(e,t),_(t,s),a||(o=[J(l,"input",f[9]),J(e,"submit",be(f[5]))],a=!0)},p(i,n){n&2&&l.value!==i[1]&&ee(l,i[1])},d(i){i&&m(e),a=!1,ve(o)}}}function Oe(f){let e,l,r,t;const s=[ye,Ee],a=[];function o(i,n){return i[0].profileNotCreated?0:1}return e=o(f),l=a[e]=s[e](f),{c(){l.c(),r=R()},l(i){l.l(i),r=R()},m(i,n){a[e].m(i,n),N(i,r,n),t=!0},p(i,[n]){let u=e;e=o(i),e===u?a[e].p(i,n):(ce(),X(a[u],1,1,()=>{a[u]=null}),ue(),l=a[e],l?l.p(i,n):(l=a[e]=s[e](i),l.c()),Z(l,1),l.m(r.parentNode,r))},i(i){t||(Z(l),t=!0)},o(i){X(l),t=!1},d(i){a[e].d(i),i&&m(r)}}}function Ie(f,e,l){let r,t;fe(f,we,d=>l(4,t=d));let{$$slots:s={},$$scope:a}=e,{data:o}=e,i="",n=!1;async function u(){var O;let{data:d,error:Y}=await o.supabase.from("profiles").select("*").eq("username",i);if(d==null||d.length==0){const{data:D,error:q}=await o.supabase.from("profiles").insert({id:(O=o.session)==null?void 0:O.user.id,username:i});if(q){j.warning(q.message);return}l(2,n=!0),j.success(`Username set to ${i}. Reloading page.`),setTimeout(()=>{ke("/profile/"+i,{replaceState:!0})},1e3)}else j.warning("This username is already taken.")}async function p(){var Y,O,D;let d;if(o.youFollow){const{error:q}=await o.supabase.from("follows").delete().eq("follower_id",(Y=o.session)==null?void 0:Y.user.id).eq("following_id",o.profileData.id);d=q}else{const{error:q}=await o.supabase.from("follows").insert({follower_id:(O=o.session)==null?void 0:O.user.id,following_id:(D=o.profileData)==null?void 0:D.id});d=q}if(d){j.warning("An error occured.");return}l(0,o.youFollow=!o.youFollow,o)}function L(){i=this.value,l(1,i)}return f.$$set=d=>{"data"in d&&l(0,o=d.data),"$$scope"in d&&l(7,a=d.$$scope)},f.$$.update=()=>{var d,Y,O,D;f.$$.dirty&1&&l(3,r=[{title:"Games",count:((d=o==null?void 0:o.games)==null?void 0:d.count)||0},{title:"Likes",count:((Y=o==null?void 0:o.likes)==null?void 0:Y.count)||0},{title:"Followers",count:((O=o==null?void 0:o.follower)==null?void 0:O.count)||0},{title:"Following",count:((D=o==null?void 0:o.following)==null?void 0:D.count)||0}])},[o,i,n,r,t,u,p,a,s,L]}class Ve extends re{constructor(e){super(),ie(this,e,Ie,Oe,ne,{data:0})}}export{Ve as component};
